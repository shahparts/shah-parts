(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2222],{72590:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return t(14496)}])},86571:function(e,s,t){"use strict";var l=t(85893);t(67294);var r=t(94704),a=t(89552),n=t(63780),i=t(42459),c=t(97362);let{Step:d}=r.default;s.Z=e=>{let{loading:s,step:t}=e;return(0,l.jsx)(a.default,{spinning:s,children:(0,l.jsxs)(r.default,{current:t,children:[(0,l.jsx)(d,{title:"Cart",icon:(0,l.jsx)(i.Z,{}),description:"Items added to cart"}),(0,l.jsx)(d,{title:"Checkout and Payment",icon:(0,l.jsx)(n.Z,{}),description:"Address is filled and Payment is done"}),(0,l.jsx)(d,{title:"Order Complete",icon:(0,l.jsx)(c.Z,{}),description:"Order is completed"})]})})}},14496:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return checkout}});var l=t(85893),r=t(67294),a=t(10368),n=t.n(a),i=t(5789),c=t(74253),d=t(97538),o=t(51024),u=t(55673),h=t(86978),p=t(38293),m=t(11163),x=t(30381),j=t.n(x),_=t(5121),f=t(80912),v=t(45770),g=t(72635),N=t.n(g),b=t(86571),k=t(75021);let y={layout:"vertical"},PaypalButtonWrapper=e=>{let{currency:s,showSpinner:t,placeOrder:a,amount:n}=e,[{options:i,isPending:c},d]=(0,k.Up)();return(0,r.useEffect)(()=>{d({type:"resetOptions",value:{...i,currency:s}})},[s,t]),(0,l.jsxs)(l.Fragment,{children:[t&&c&&(0,l.jsx)("div",{className:"spinner"}),(0,l.jsx)(k.ch,{forceReRender:[n,s,y],createOrder:(e,t)=>t.order.create({purchase_units:[{amount:{currency_code:s,value:n}}]}).then(e=>e),onApprove:function(e,s){return console.log(e),s.order.capture().then(function(e){a(e)})}})]})};var A=t(41664),S=t.n(A),checkout=()=>{let{TextArea:e}=o.default,[s]=d.Z.useForm(),t=(0,m.useRouter)(),[a,x]=(0,r.useState)(!1),[g,y]=(0,r.useState)({}),[A,Z]=(0,r.useState)(!1),[w,C]=(0,r.useState)(""),[I,P]=(0,r.useState)(!1),[T,E]=(0,r.useState)({}),[D,O]=(0,r.useState)({}),{cart:F,clearCart:M}=(0,v.i)();(0,r.useMemo)(()=>N()().getData(),[]);let R=null==F?void 0:F.reduce((e,s)=>e+parseInt(null==s?void 0:s.Price)*parseInt(null==s?void 0:s.qtyToShop),0),transactionSuccess=async e=>{var s,l;await _.Z.post("".concat("https://www.shahparts.com/api","/orders/place-order"),{notes:w,placed:j()().format("DD/MM/YYYY"),subTotal:R,shipping:0,paymentMethod:"Paypal",totalAmount:R+0,user:{email:null==T?void 0:T.email,fullName:null==T?void 0:T.fullName},cartProducts:F,billingAddress:T,shippingAddress:D,paymentData:e,userId:null===(s=(0,f.$8)())||void 0===s?void 0:s._id,email:null===(l=(0,f.$8)())||void 0===l?void 0:l.email},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).then(e=>{console.log(e),200===e.status?(M(),(0,h.Ik)(e.data.successMessage),setTimeout(()=>{(0,f.$8)()?t.push("/user/orders"):t.push("/")},2e3)):(0,h.hW)(e.data.errorMessage)}).catch(e=>{x(!1),console.log(e),(0,h.hW)(null==e?void 0:e.message)})};return(0,l.jsxs)("div",{className:n().checkout,children:[(0,l.jsx)("div",{className:"p-[30px]",children:(0,l.jsx)(b.Z,{step:1,loading:a})}),(0,l.jsx)("h1",{className:"".concat(n().title," mainTitle"),children:"Checkout"}),(0,l.jsxs)(u.Z,{gutter:[23,23],children:[(0,l.jsx)(i.Z,{xs:24,md:17,children:(0,l.jsxs)("div",{className:"p-[17px] md:p-[20px]",style:{maxWidth:800},children:[(0,l.jsx)("div",{className:"pb-[23px]",children:(0,l.jsx)(S(),{className:"text-[23px] text-red-500",href:"/shop",children:"Continue Shopping ?"})}),A?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("h2",{className:"text-[28px]",children:["Please pay total amount of ",(0,l.jsxs)("b",{children:["$",R+0]})," to process your order."]}),(0,l.jsx)(k.Vv,{options:{"client-id":"AT1WWRJ4sJGTsCPueT8FZuNBYECFXJEGE2t2dOno0MCo3xk1zhuX6CbPhR8zv_yn7RZsRz4X8pYShmBo",components:"buttons",currency:"USD"},children:(0,l.jsx)(PaypalButtonWrapper,{amount:R+0,placeOrder:transactionSuccess,currency:"USD",showSpinner:!1})})]}):(0,l.jsx)(d.Z,{layout:"vertical",form:s,name:"nest-messages",className:n().form,initialValues:{billingAddress:{fullName:"",address:"",address2:""}},children:(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"mb-8",children:"Billing Details: "}),(0,l.jsx)(d.Z.Item,{name:["billingAddress","fullName"],label:"Full Name",rules:[{required:!0,message:"Please enter your Full Name!"}],children:(0,l.jsx)(o.default,{placeholder:"Enter Full Name"})}),(0,l.jsx)(u.Z,{gutter:[23,23],children:(0,l.jsxs)(i.Z,{xs:24,children:[(0,l.jsx)(d.Z.Item,{name:["billingAddress","address"],label:"Address",rules:[{required:!0,message:"Please enter your Address!"}],children:(0,l.jsx)(o.default,{placeholder:"Enter Address 2"})}),(0,l.jsx)(d.Z.Item,{name:["billingAddress","address2"],children:(0,l.jsx)(o.default,{placeholder:"Enter Apartment, suit, unit etc(optional)"})})]})})]})})]})}),(0,l.jsx)(i.Z,{xs:24,md:7,className:n().right,children:(0,l.jsxs)("div",{className:"p-[17px] md:p-[20px] mb-10 md:mb-0",children:[(0,l.jsx)("h3",{children:"Order Details:"}),null==F?void 0:F.map((e,s)=>(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsxs)("h4",{className:"font-bolder text-[16px] max-w-[170px]",children:[null==e?void 0:e.title," x ",null==e?void 0:e.qtyToShop]}),(0,l.jsx)("div",{className:"w-fit",children:(0,l.jsxs)("h4",{className:"font-bold text-[16px]",children:["$",parseInt(null==e?void 0:e.Price)*parseInt(null==e?void 0:e.qtyToShop)]})})]},s)),(0,l.jsx)(c.Z,{}),(0,l.jsxs)("div",{className:n().orderDetailItem,children:[(0,l.jsx)("h5",{children:"Sub Total"}),(0,l.jsxs)("h5",{children:["$",R]})]}),(0,l.jsxs)("div",{className:n().orderDetailItem,children:[(0,l.jsx)("h5",{children:"Shipping"}),(0,l.jsx)("a",{href:"https://wa.me/818050821650",target:"_blank",className:n().whatsApp,children:"Contact on Whatsapp"})]}),(0,l.jsxs)("div",{className:n().orderDetailItem,children:[(0,l.jsxs)("h5",{children:["Order Total ",(0,l.jsx)("br",{})]}),(0,l.jsxs)("h5",{children:["$",R]})]}),(0,l.jsx)("div",{children:(0,l.jsx)(p.C,{text:"MAKE PAYMENT",loading:a,disabled:a,onClick:()=>{s.submit();let{billingAddress:e}=s.getFieldsValue();(null==e?void 0:e.fullName)&&(null==e?void 0:e.address)&&(E(e),Z(!0))}})})]})})]})]})}},10368:function(e){e.exports={checkout:"checkout_checkout__zCm2g",title:"checkout_title__y4HGc",TextArea:"checkout_TextArea__tcVby",auth:"checkout_auth__TEiOH",form:"checkout_form__5zQIa",right:"checkout_right__tm1Gl",promotionCode:"checkout_promotionCode__iRB7C",orderDetailItem:"checkout_orderDetailItem___bhnc",whatsApp:"checkout_whatsApp__6LkXP"}}},function(e){e.O(0,[4885,4055,7538,2055,227,5168,9774,2888,179],function(){return e(e.s=72590)}),_N_E=e.O()}]);